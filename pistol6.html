<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pistolskytte Logg</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    margin: 0;
    padding: 20px;
    text-align: center;
}

.page { display: none; max-width: 500px; margin: 0 auto; }
.show { display: block !important; }

h1, h2 { margin-bottom: 20px; }

/* STARTSKÃ„RM */
.big-btn {
    width: 100%;
    padding: 22px;
    font-size: 22px;
    margin-bottom: 15px;
    border: none;
    border-radius: 18px;
    color: white;
    font-weight: bold;
    cursor: pointer;
}

/* FÃ¤rger */
.prec-btn { background: #1e88e5; }
.snabb-btn { background: #43a047; }
.log-btn { background: #512da8; }
.export-btn { background: #4a148c; }

/* EXPORT undermeny */
.export-sub-btn {
    width: 100%;
    padding: 18px;
    background: #6a1b9a;
    border: none;
    color: white;
    font-size: 18px;
    border-radius: 12px;
    margin-bottom: 10px;
}

/* INMATNING */
.shot-display {
    font-size: 26px;
    font-weight: bold;
    padding: 12px;
    background: white;
    border-radius: 12px;
    margin-bottom: 20px;
}

.grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
}

.num-btn {
    padding: 22px 0;
    font-size: 26px;
    font-weight: bold;
    background: #0d47a1;
    color: white;
    border-radius: 16px;
    border: none;
    cursor: pointer;
}

.small-btn {
    padding: 16px;
    font-size: 16px;
    border-radius: 12px;
    border: none;
    color: white;
    margin: 10px;
    width: 45%;
    cursor: pointer;
}

.undo { background: #ffb300; color: black; }
.clear { background: #c62828; }
.save { background: #1b5e20; width: 100%; }
.back { background: #b71c1c; width: 100%; margin-top: 10px; }

/* LOGGBOK */
.log-card {
    background: white;
    padding: 12px;
    border-radius: 12px;
    margin-bottom: 12px;
    text-align: left;
}
.log-del {
    background: #c62828;
    border: none;
    color: white;
    padding: 8px 12px;
    border-radius: 8px;
    float: right;
}
</style>
</head>

<body>

<!-- ================= STARTSKÃ„RM ================= -->
<div id="start" class="page show">
<h1>Pistolskytte Logg</h1>

<button class="big-btn prec-btn" onclick="startSeries('.22 B â€“ Precision',5)">.22 B â€“ Precision</button>
<button class="big-btn prec-btn" onclick="startSeries('9mm B â€“ Precision',5)">9mm B â€“ Precision</button>

<button class="big-btn snabb-btn" onclick="startSeries('.22 B â€“ Snabbserie',6)">.22 B â€“ Snabbserie</button>
<button class="big-btn snabb-btn" onclick="startSeries('9mm B â€“ Snabbserie',6)">9mm B â€“ Snabbserie</button>

<button class="big-btn log-btn" onclick="openLogbook()">ðŸ“’ Loggbok</button>

<button class="big-btn export-btn" onclick="toggleExport()">ðŸ“¤ Exportera</button>

<div id="exportMenu" style="display:none;">
    <button class="export-sub-btn" onclick="exportExcel()">ðŸ“Š Excel</button>
    <button class="export-sub-btn" onclick="exportPDF()">ðŸ“„ PDF</button>
    <button class="export-sub-btn" onclick="exportCSV()">ðŸ“„ CSV</button>
</div>
</div>

<!-- ================= INMATNING ================= -->
<div id="series" class="page">
<h2 id="seriesTitle"></h2>

<div class="shot-display" id="shotList"></div>

<div class="grid">
    <button class="num-btn">X</button>
    <button class="num-btn">10</button>
    <button class="num-btn">9</button>
    <button class="num-btn">8</button>
    <button class="num-btn">7</button>
    <button class="num-btn">6</button>
    <button class="num-btn">5</button>
    <button class="num-btn">4</button>
    <button class="num-btn">3</button>
    <button class="num-btn">2</button>
    <button class="num-btn">1</button>
    <button class="num-btn">0</button>
</div>

<button class="small-btn undo" onclick="undo()">âŸ² Ã…ngra</button>
<button class="small-btn clear" onclick="clearAll()">ðŸ—‘ Rensa</button>

<button class="small-btn save" onclick="saveSeries()">ðŸ’¾ Spara serie</button>
<button class="small-btn back" onclick="goHome()">â¬… Tillbaka</button>
</div>

<!-- ================= LOGGBOK ================= -->
<div id="log" class="page">
<h2>Loggbok</h2>
<div id="logList"></div>
<button class="small-btn back" onclick="goHome()">â¬… Tillbaka</button>
</div>

<script>
let shots = [];
let maxShots = 5;
let currentType = "";
let logData = JSON.parse(localStorage.getItem("logData") || "[]");

function showPage(id) {
    document.querySelectorAll(".page").forEach(p => p.classList.remove("show"));
    document.getElementById(id).classList.add("show");
}

function startSeries(type, count){
    shots = [];
    maxShots = count;
    currentType = type;
    document.getElementById("seriesTitle").innerText = type;
    document.getElementById("shotList").innerText = "";
    showPage("series");
}

document.querySelectorAll(".num-btn").forEach(btn => {
    btn.onclick = () => {
        if (shots.length >= maxShots) return;
        let val = btn.innerText === "X" ? "X" : btn.innerText;
        shots.push(val);
        updateShots();
    };
});

function updateShots(){
    document.getElementById("shotList").innerText = shots.join(" â€“ ");
}

function undo(){
    shots.pop();
    updateShots();
}

function clearAll(){
    shots = [];
    updateShots();
}

function saveSeries(){
    if (shots.length !== maxShots) {
        alert("Du mÃ¥ste fylla i " + maxShots + " skott!");
        return;
    }

    let score = shots.reduce((a,b)=>a + (b==="X"?10:parseInt(b)),0);

    logData.push({
        id: Date.now(),
        date: new Date().toLocaleDateString(),
        type: currentType,
        shots: [...shots],
        score: score
    });

    localStorage.setItem("logData", JSON.stringify(logData));
    alert("Serie sparad!");
    goHome();
}

function openLogbook(){
    let c = document.getElementById("logList");
    c.innerHTML = "";

    logData.forEach(entry => {
        let div = document.createElement("div");
        div.className = "log-card";
        div.innerHTML = `
            <b>${entry.date}</b> â€“ ${entry.type}<br>
            Skott: ${entry.shots.join(" â€“ ")}<br>
            PoÃ¤ng: <b>${entry.score}</b>
            <button class="log-del" onclick="del(${entry.id})">Ta bort</button>
        `;
        c.appendChild(div);
    });

    showPage("log");
}

function del(id){
    logData = logData.filter(e => e.id !== id);
    localStorage.setItem("logData", JSON.stringify(logData));
    openLogbook();
}

function goHome(){
    showPage("start");
}

function toggleExport(){
    let m = document.getElementById("exportMenu");
    m.style.display = m.style.display === "none" ? "block" : "none";
}

function exportCSV(){
    alert("CSV export kommer senare. (Filen fungerar, men denna Ã¤r placeholder)");
}

function exportExcel(){ alert("Excel export kommer senare."); }
function exportPDF(){ alert("PDF export kommer senare."); }
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pistolskytte Logg</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1e88e5">

<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #f2f2f2;
    margin: 0;
    padding: 20px;
}

h1 { font-size: 32px; margin-bottom: 30px; }

.blue-btn, .green-btn, .logbook-btn, .export-main-btn {
    width: min(80%, 480px);
    padding: 18px;
    margin: 14px auto;
    border: none;
    border-radius: 14px;
    font-size: 22px;
    font-weight: bold;
    color: white;
}

.blue-btn { background:#1e88e5; }
.green-btn { background:#43a047; }
.logbook-btn { background:#512da8; }
.export-main-btn { background:#4a148c; }

.export-sub-btn {
    width: min(70%, 400px);
    background:#6a1b9a;
    color:white;
    padding:14px;
    margin:8px auto;
    border:none;
    border-radius:12px;
    font-size:20px;
}

input[type=number] {
    font-size: 28px;
    width: 90px;
    margin: 10px;
}

.save-btn {
    background:#1b5e20;
    color:white;
    padding:14px;
    font-size:22px;
    border-radius:10px;
    border:none;
    margin-top: 20px;
}

.back-btn {
    background:#b71c1c;
    color:white;
    padding:14px;
    font-size:22px;
    border-radius:10px;
    border:none;
    margin-top:20px;
}
</style>
</head>

<body>

<h1>Pistolskytte Logg</h1>

<button class="blue-btn" onclick="startSeries('.22 B ‚Äì Precision')">.22 B ‚Äì Precision</button>
<button class="blue-btn" onclick="startSeries('9mm B ‚Äì Precision')">9mm B ‚Äì Precision</button>

<button class="green-btn" onclick="startSeries('.22 B ‚Äì Snabbserie')">.22 B ‚Äì Snabbserie</button>
<button class="green-btn" onclick="startSeries('9mm B ‚Äì Snabbserie')">9mm B ‚Äì Snabbserie</button>

<button class="logbook-btn" onclick="location.href='loggbok.html'">üìí Loggbok</button>

<button class="export-main-btn" onclick="toggleExportMenu()">üì§ Exportera</button>

<div id="exportMenu" style="display:none;">
    <button class="export-sub-btn" onclick="exportExcel()">üìä Exportera Excel</button>
    <button class="export-sub-btn" onclick="exportPDF()">üìÑ Exportera PDF</button>
</div>

<div id="seriesDiv" style="display:none;">
    <h2 id="seriesTitle"></h2>
    <p>Ange dina 5 skott:</p>

    <div>
        <input type="number" id="s1" min="0" max="10">
        <input type="number" id="s2" min="0" max="10">
        <input type="number" id="s3" min="0" max="10">
        <input type="number" id="s4" min="0" max="10">
        <input type="number" id="s5" min="0" max="10">
    </div>

    <button class="save-btn" onclick="saveSeries()">üíæ Spara serie</button><br>
    <button class="back-btn" onclick="backToMenu()">‚¨ÖÔ∏è Tillbaka</button>
</div>


<script>
// ALL FUNCTIONS IN GLOBAL SCOPE
let selectedType = "";

window.startSeries = function(type){
    selectedType = type;
    document.getElementById("seriesTitle").innerText = type;
    document.getElementById("seriesDiv").style.display = "block";
};

window.backToMenu = function(){
    document.getElementById("seriesDiv").style.display = "none";
};

window.toggleExportMenu = function(){
    let menu = document.getElementById("exportMenu");
    menu.style.display = (menu.style.display === "none") ? "block" : "none";
};

window.saveSeries = function(){
    let s1 = +document.getElementById("s1").value;
    let s2 = +document.getElementById("s2").value;
    let s3 = +document.getElementById("s3").value;
    let s4 = +document.getElementById("s4").value;
    let s5 = +document.getElementById("s5").value;

    let lista = JSON.parse(localStorage.getItem("pistolLogg") || "[]");

    lista.push({
        typ: selectedType,
        skott: [s1, s2, s3, s4, s5],
        total: s1 + s2 + s3 + s4 + s5,
        tid: new Date().toLocaleString()
    });

    localStorage.setItem("pistolLogg", JSON.stringify(lista));

    alert("Serie sparad!");

    document.getElementById("s1").value = "";
    document.getElementById("s2").value = "";
    document.getElementById("s3").value = "";
    document.getElementById("s4").value = "";
    document.getElementById("s5").value = "";
};

window.exportExcel = function(){
    let data = localStorage.getItem("pistolLogg") || "[]";
    let blob = new Blob([data], { type: "application/vnd.ms-excel" });
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "pistol_logg.xls";
    a.click();
};

window.exportPDF = function(){
    let data = localStorage.getItem("pistolLogg") || "[]";
    let blob = new Blob([data], { type: "application/pdf" });
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "pistol_logg.pdf";
    a.click();
};
</script>

<script>
// PWA registrering
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pistolskytte Logg</title>

<!-- PWA offline -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1e88e5">
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}
</script>

<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #f2f2f2;
    margin: 0;
    padding: 20px;
}

h1 {
    font-size: 32px;
    margin-bottom: 30px;
}

/* Huvudknappar (precision/snabbserie/logg/export) */
.blue-btn,
.green-btn,
.logbook-btn,
.export-main-btn {
    width: min(80%, 480px);
    padding: 18px;
    margin: 14px auto;
    border: none;
    border-radius: 14px;
    font-size: 22px;
    font-weight: bold;
    color: white;
}

.blue-btn { background: #1e88e5; }
.green-btn { background: #43a047; }
.logbook-btn { background: #512da8; }
.export-main-btn { background: #4a148c; }

/* Undermenyn */
.export-sub-btn {
    width: min(70%, 400px);
    background: #6a1b9a;
    color: white;
    padding: 14px;
    margin: 8px auto;
    border: none;
    border-radius: 12px;
    font-size: 20px;
    display: block;
}

input[type=number] {
    font-size: 28px;
    width: 90px;
    margin: 10px;
}

.save-btn {
    background: #1b5e20;
    color: white;
    padding: 14px;
    border-radius: 10px;
    font-size: 22px;
    border: none;
    margin-top: 20px;
}

.back-btn {
    background: #b71c1c;
    color: white;
    padding: 14px;
    border-radius: 10px;
    font-size: 22px;
    border: none;
    margin-top: 20px;
}
</style>
</head>

<body>

<h1>Pistolskytte Logg</h1>

<!-- KNAPPAR -->
<button class="blue-btn" onclick="startSeries('.22 B ‚Äì Precision')">.22 B ‚Äì Precision</button>
<button class="blue-btn" onclick="startSeries('9mm B ‚Äì Precision')">9mm B ‚Äì Precision</button>

<button class="green-btn" onclick="startSeries('.22 B ‚Äì Snabbserie')">.22 B ‚Äì Snabbserie</button>
<button class="green-btn" onclick="startSeries('9mm B ‚Äì Snabbserie')">9mm B ‚Äì Snabbserie</button>

<!-- Borttagna 25 m-knapparna -->

<button class="logbook-btn" onclick="window.location.href='loggbok.html'">üìí Loggbok</button>

<!-- Export -->
<button class="export-main-btn" onclick="toggleExportMenu()">üì§ Exportera</button>

<div id="exportMenu" style="display:none;">
    <button class="export-sub-btn" onclick="exportExcel()">üìä Exportera Excel</button>
    <button class="export-sub-btn" onclick="exportPDF()">üìÑ Exportera PDF</button>
</div>


<!-- REGISTRERING AV SERIE -->
<div id="seriesDiv" style="display:none;">
    <h2 id="seriesTitle"></h2>
    <p>Ange dina 5 skott:</p>

    <div>
        <input type="number" id="s1" min="0" max="10">
        <input type="number" id="s2" min="0" max="10">
        <input type="number" id="s3" min="0" max="10">
        <input type="number" id="s4" min="0" max="10">
        <input type="number" id="s5" min="0" max="10">
    </div>

    <button class="save-btn" onclick="saveSeries()">üíæ Spara serie</button>
    <button class="back-btn" onclick="backToMenu()">‚¨ÖÔ∏è Tillbaka</button>
</div>



<script>
let selectedType = "";

/* Starta serie */
function startSeries(type) {
    selectedType = type;
    document.getElementById("seriesTitle").innerText = type;
    document.getElementById("seriesDiv").style.display = "block";
}

/* Spara serie */
function saveSeries() {
    let s1 = document.getElementById("s1").value;
    let s2 = document.getElementById("s2").value;
    let s3 = document.getElementById("s3").value;
    let s4 = document.getElementById("s4").value;
    let s5 = document.getElementById("s5").value;

    let lista = JSON.parse(localStorage.getItem("pistolLogg") || "[]");

    lista.push({
        typ: selectedType,
        skott: [s1, s2, s3, s4, s5],
        total: Number(s1)+Number(s2)+Number(s3)+Number(s4)+Number(s5),
        tid: new Date().toLocaleString()
    });

    localStorage.setItem("pistolLogg", JSON.stringify(lista));

    alert("Serie sparad!");

    // Rensa siffror men stanna kvar
    document.getElementById("s1").value = "";
    document.getElementById("s2").value = "";
    document.getElementById("s3").value = "";
    document.getElementById("s4").value = "";
    document.getElementById("s5").value = "";
}

/* Tillbaka */
function backToMenu() {
    document.getElementById("seriesDiv").style.display = "none";
}

/* Export meny */
function toggleExportMenu() {
    let menu = document.getElementById("exportMenu");
    menu.style.display = (menu.style.display === "none") ? "block" : "none";
}

/* Excel-export */
function exportExcel() {
    let data = localStorage.getItem("pistolLogg") || "[]";
    let blob = new Blob([data], { type: "application/vnd.ms-excel" });

    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "pistol_logg.xls";
    a.click();
}

/* PDF-export */
function exportPDF() {
    let data = localStorage.getItem("pistolLogg") || "[]";
    let blob = new Blob([data], { type: "application/pdf" });

    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "pistol_logg.pdf";
    a.click();
}
</script>

</body>
</html>
